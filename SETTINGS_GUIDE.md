# 設定画面ガイド

このドキュメントでは、設定画面の使い方とカスタマイズ方法を説明します。

## 設定画面を開く

### ハンバーガーメニューボタン

画面右上のヘッダーにある **≡** ボタンをクリックすると、設定画面が開きます。

```
┌─────────────────────────────────────────────┐
│ ● ● ●    terminal@chat    [≡] [クリア] 12:00 │  ← ここをクリック
└─────────────────────────────────────────────┘
```

## 設定項目

### 🤖 OpenAI API キー（必須）

**説明**: OpenAI APIにアクセスするためのAPIキー

**取得方法**:
1. [OpenAI Platform](https://platform.openai.com/api-keys) にアクセス
2. ログインまたはアカウント作成
3. "Create new secret key" でAPIキーを生成
4. 生成されたキー（`sk-...`で始まる文字列）をコピー

**入力方法**:
- テキストボックスに`sk-...`で始まるAPIキーを貼り付け
- デフォルトでは非表示（マスク）されています
- 👁️ボタンで表示/非表示を切り替え可能

**セキュリティ**:
- APIキーはブラウザのローカルストレージに保存されます
- サーバーには送信されません
- 第三者と共有しないでください

### 🤖 OpenAI モデル

**説明**: 使用するOpenAI GPTモデルを選択

**選択可能なモデル**:

### GPT-5シリーズ（2025年8月リリース）

| モデル | 特徴 | 推奨用途 | コスト | 速度 |
|--------|------|---------|--------|------|
| **GPT-5** ⭐ | 標準版・推奨 | あらゆるタスクに最適 | 高 | 標準 |
| **GPT-5-mini** | 高速・効率的 | 日常会話、迅速な応答 | 中 | 高速 |
| **GPT-5-nano** | 超軽量 | リソース制約環境、リアルタイム | 低 | 超高速 |
| **GPT-5-pro** | 最高性能 | 最高品質が必要なタスク | 最高 | 標準 |
| **GPT-5-thinking** | 深い推論 | 複雑な問題、戦略的思考 | 高 | 低速 |

### その他のモデル

| モデル | リリース | 特徴 | 推奨用途 | コスト |
|--------|---------|------|---------|--------|
| **o1** | 2024年 | 高度な推論 | 複雑な問題解決、論理的思考 | 高 |
| **o1-mini** | 2024年 | 推論・低コスト | 科学・数学・プログラミング | 中 |
| **GPT-4o** | 2024年 | 高性能 | 汎用的なタスク | 高 |
| **GPT-4o-mini** | 2024年 | 高速・効率的 | 日常的な会話 | 中 |
| **GPT-4 Turbo** | 2023年 | 高性能・長文対応 | 長文処理 | 高 |
| **GPT-3.5 Turbo** | 2023年 | 低コスト | 簡単な質問、大量処理 | 低 |

**デフォルト**: GPT-5（推奨）

**選び方**:

#### 目的別
- **一般的な用途（推奨）**: **GPT-5**
- **速度重視**: **GPT-5-mini** または **GPT-5-nano**
- **最高品質**: **GPT-5-pro**
- **複雑な推論・戦略**: **GPT-5-thinking** または **o1**
- **コスト重視**: **GPT-5-nano** または **GPT-3.5 Turbo**

#### 特殊な用途
- **プログラミング**: **o1** または **o1-mini**
- **数学・科学**: **o1** または **GPT-5-thinking**
- **リアルタイム対話**: **GPT-5-nano**

**GPT-5シリーズの特徴**（2025年8月リリース）:
- **自律的なツール統合**: ウェブブラウジング、Python実行、画像生成などを自動で使い分け
- **より高速で効率的**: 従来モデルより大幅な性能向上
- **技術統合**: GPTシリーズとoシリーズの技術を統合
- **柔軟なバリエーション**: 用途に応じて5つのバリエーションから選択可能
- **無料ユーザーにも対応**: 使用制限ありで無料版でも利用可能

### ⚡ タイプライター速度

**説明**: AIの応答メッセージを一文字ずつ表示する速度

**設定方法**:
- スライダーを左右に動かして調整
- 範囲: 10ms（高速）〜 100ms（低速）
- デフォルト: 20ms

**推奨値**:
- **高速 (10-20ms)**: すぐに読みたい場合
- **標準 (20-40ms)**: バランスの良い速度
- **低速 (50-100ms)**: タイプライター感を楽しみたい場合

### 🔌 MCP エンドポイント（オプション）

**説明**: Model Context Protocol サーバーのWebSocketエンドポイント

**デフォルト値**: `ws://localhost:8080`

**用途**: 将来のLangGraph統合で使用予定

**注意**: 現在は実装されていないため、変更する必要はありません

### 📜 自動スクロール

**説明**: 新しいメッセージが表示されたときに自動的にスクロールする機能

**設定方法**:
- チェックボックスをオン/オフ

**推奨**:
- **オン（デフォルト）**: 最新のメッセージを常に表示
- **オフ**: 過去のメッセージを読んでいるときに便利

## 🔧 詳細設定（上級者向け）

設定画面の下部にある「詳細設定」を展開すると、以下の項目を調整できます。

### 🌡️ Temperature（創造性）

**説明**: AIの応答のランダム性・創造性を制御

**範囲**: 0.0 〜 2.0

**デフォルト**: 0.7

**効果**:
- **0.0 〜 0.3**: 保守的・一貫性重視
  - 事実に基づく質問
  - 専門的な内容
  - プログラミングコード
- **0.4 〜 1.0**: バランス
  - 一般的な会話
  - 創造的だが合理的
- **1.1 〜 2.0**: 創造的・多様性重視
  - ブレインストーミング
  - 創作活動
  - 多様なアイデアが欲しい

**注意**: 
- 高すぎると矛盾した応答になる可能性があります
- **GPT-5シリーズとo1シリーズでは設定不可**: これらのモデルはデフォルト値(1.0)が固定されています
- カスタマイズが必要な場合はGPT-4シリーズを使用してください

### 📏 最大トークン数（max_completion_tokens）

**説明**: AIの応答の最大長を制限

**範囲**: 100 〜 4000トークン

**デフォルト**: 1000トークン

**目安**:
- 100トークン: 約75単語（短い回答）
- 500トークン: 約375単語（標準的な段落）
- 1000トークン: 約750単語（詳細な説明）
- 2000トークン: 約1500単語（長文）
- 4000トークン: 約3000単語（非常に長い応答）

**注意**: 
- 大きいほど長い応答が可能ですが、コストが増加します
- モデルによって最大値が異なります
- 日本語は英語より多くのトークンを消費します

**重要**: 
- GPT-5シリーズとo1シリーズでは`max_completion_tokens`パラメータが使用されます
- GPT-4以前のモデルでは`max_tokens`パラメータが使用されます
- アプリが自動的に適切なパラメータ名を選択します

## 設定の保存

### 保存方法

1. 必要な項目を入力
2. 右下の **💾 保存** ボタンをクリック
3. "✓ 設定を保存しました" と表示されたら成功

### 保存できない場合

- **OpenAI APIキーが空**: 必須項目です
- **保存ボタンがグレーアウト**: APIキーを入力してください

### 保存される場所

設定はブラウザの**ローカルストレージ**に保存されます：

```javascript
// 保存場所
localStorage.getItem('chat_app_settings')
```

**特徴**:
- ブラウザを閉じても保存される
- 次回起動時に自動的に読み込まれる
- ブラウザのキャッシュをクリアすると削除される

## UIUXベストプラクティス

このアプリの設定画面は、以下のベストプラクティスに従って設計されています：

### 1. 明確なラベル
各設定項目には絵文字とわかりやすい日本語ラベルがあります。

### 2. ヘルプテキスト
💡 マークで各設定の説明を表示します。

### 3. 即時フィードバック
- 保存成功時: 緑色の "✓ 設定を保存しました"
- 保存失敗時: 赤色の "✗ 保存に失敗しました"

### 4. セキュリティ
- APIキーはデフォルトでマスク表示
- 表示/非表示の切り替えが可能

### 5. バリデーション
- 必須項目が未入力の場合、保存ボタンを無効化
- エラーメッセージで理由を説明

### 6. レスポンシブデザイン
- モバイルでも使いやすい
- 画面サイズに応じて調整

### 7. アクセシビリティ
- `aria-label`で画面リーダー対応
- キーボード操作に対応
- コントラスト比を考慮した色使い

## よくある質問

### Q: 設定を変更したが反映されない

**A**: 以下を確認してください：
1. **保存ボタンをクリックしたか**
2. **"✓ 設定を保存しました"と表示されたか**
3. **ブラウザをリロードしてみる**

### Q: APIキーを忘れた

**A**: OpenAI Platformで確認または再生成できます：
1. [platform.openai.com](https://platform.openai.com/api-keys)
2. 既存のキーは表示されないため、新しいキーを生成

### Q: 設定を初期化したい

**A**: ブラウザの開発者ツール（F12）で：
```javascript
localStorage.removeItem('chat_app_settings');
location.reload();
```

### Q: 設定をエクスポート/バックアップしたい

**A**: 開発者ツール（F12）のコンソールで：
```javascript
// エクスポート
const settings = localStorage.getItem('chat_app_settings');
console.log(settings);
// コピーして保存

// インポート
localStorage.setItem('chat_app_settings', '貼り付けた設定JSON');
location.reload();
```

### Q: 複数のブラウザで同じ設定を使いたい

**A**: 
1. 上記の方法で設定をエクスポート
2. 他のブラウザでインポート
3. または、各ブラウザで手動で設定を入力

### Q: タイプライター効果を完全に無効化したい

**A**: 速度を最小値（10ms）に設定するか、コードで無効化：
```typescript
// src/components/ChatMessage.tsx
enableTypewriter={false}
```

## トラブルシューティング

### 設定が保存されない

**原因**: ブラウザのプライベートモード/シークレットモード

**解決方法**: 通常モードでブラウザを開く

### APIキーエラーが出る

```
エラー: OpenAI API error: Invalid API key
```

**確認事項**:
1. APIキーが正しいか（`sk-`で始まる）
2. スペースが入っていないか
3. APIキーが有効か（OpenAI Platformで確認）
4. APIクレジットが残っているか

### 設定画面が開かない

**確認事項**:
1. JavaScript が有効か
2. ブラウザのコンソール（F12）でエラーを確認
3. ブラウザをリロード

## 開発者向け情報

### ストレージキー

```typescript
const STORAGE_KEY = 'chat_app_settings';
```

### デフォルト設定

```typescript
const DEFAULT_SETTINGS: AppSettings = {
  openaiApiKey: '',
  typewriterSpeed: 20,
  mcpEndpoint: 'ws://localhost:8080',
  theme: 'dark',
  autoScroll: true,
};
```

### 設定の型定義

```typescript
export interface AppSettings {
  openaiApiKey: string;
  typewriterSpeed: number;
  mcpEndpoint: string;
  theme?: 'dark' | 'light';
  autoScroll: boolean;
}
```

### APIの使用例

```typescript
import { loadSettings, saveSettings } from './utils/storage';

// 読み込み
const settings = loadSettings();

// 保存
saveSettings({ openaiApiKey: 'sk-...' });

// 特定の値を取得
import { getSetting } from './utils/storage';
const apiKey = getSetting('openaiApiKey');
```

## 今後の追加予定

- [ ] テーマ切り替え（ダーク/ライト）
- [ ] フォントサイズ調整
- [ ] モデル選択（GPT-4, GPT-3.5など）
- [ ] システムプロンプトのカスタマイズ
- [ ] 会話履歴のエクスポート/インポート
- [ ] ショートカットキーのカスタマイズ
- [ ] マルチアカウント対応

## 参考リンク

- [OpenAI API Documentation](https://platform.openai.com/docs)
- [Web Storage API](https://developer.mozilla.org/ja/docs/Web/API/Web_Storage_API)
- [WCAG アクセシビリティガイドライン](https://www.w3.org/WAI/WCAG21/quickref/)

